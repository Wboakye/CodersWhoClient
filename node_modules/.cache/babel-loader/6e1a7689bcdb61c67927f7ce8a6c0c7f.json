{"ast":null,"code":"import axios from 'axios';\nimport history from '../history';\nimport * as c from '../redux/constants';\nimport store from '../redux/store';\nconst host = 'http://localhost:3005'; //const host = process.env.API_HOST;\n//LOGIN\n\nexport function login(username, password) {\n  return dispatch => {\n    dispatch(setLoginPending(true));\n    dispatch(setLoginSuccess(false));\n    dispatch(setLoginError(null));\n    callLoginApi(username, password, (data, error) => {\n      dispatch(setLoginPending(false));\n\n      if (!error) {\n        console.log(data);\n\n        if (data.success === true) {\n          dispatch(setUserToken(data.token));\n          dispatch(setLoginSuccess(true));\n          history.push('/dashboard');\n        } else {\n          dispatch(setLoginError(data.message));\n          alert(data.message);\n        }\n      } else {\n        dispatch(setLoginError(data.message));\n        alert(data.message);\n      }\n    });\n  };\n}\nexport function logout() {\n  return dispatch => {\n    sessionStorage.removeItem('CWJWT');\n    dispatch(setLoginSuccess(false));\n    history.push('/login');\n  };\n}\nexport function verifyLoggedIn() {\n  console.log(store.getState());\n\n  if (store.getState().isLoginSuccess) {\n    alert('Jwt Present, auth true');\n  } else {\n    console.log('Not logged in in STATE checking for JWT');\n\n    if (sessionStorage.getItem('CWJWT')) {\n      console.log('jwt present sending request');\n      let token = sessionStorage.getItem('CWJWT');\n      axios({\n        url: host + '/api/user/authenticate',\n        method: 'POST',\n        headers: {\n          'auth-token': token\n        }\n      }).then(response => {\n        console.log('successfully authed from stored auth token');\n        console.log(response);\n        store.dispatch(setLoginSuccess(true));\n        console.log('FINALE: ' + store.getState());\n        console.log('setting STATE logged in to TRUE');\n      }).catch(function (error) {\n        console.log(error);\n        alert('error with response');\n      });\n    } else {\n      alert('JWT not present please sign in');\n    }\n  }\n}\n\nfunction setLoginPending(isLoginPending) {\n  return {\n    type: c.SET_LOGIN_PENDING,\n    isLoginPending\n  };\n}\n\nfunction setLoginSuccess(isLoginSuccess) {\n  return {\n    type: c.SET_LOGIN_SUCCESS,\n    isLoginSuccess\n  };\n}\n\nfunction setLoginError(loginError) {\n  return {\n    type: c.SET_LOGIN_ERROR,\n    loginError\n  };\n}\n\nfunction setUserToken(token) {\n  return {\n    type: c.SET_USER_TOKEN,\n    token\n  };\n}\n\nfunction callLoginApi(username, password, callback) {\n  axios.post(host + '/api/user/login', {\n    username: username,\n    password: password\n  }).then(response => {\n    console.log(response);\n    sessionStorage.setItem('CWJWT', response.data.token);\n    return callback(response.data, null);\n  }).catch(function (error) {\n    console.log(null, error);\n    return callback(new Error('Invalid email and password'));\n  });\n}","map":{"version":3,"sources":["/Users/william/Desktop/codersWho/coderswhoclient/src/actions/auth-actions.js"],"names":["axios","history","c","store","host","login","username","password","dispatch","setLoginPending","setLoginSuccess","setLoginError","callLoginApi","data","error","console","log","success","setUserToken","token","push","message","alert","logout","sessionStorage","removeItem","verifyLoggedIn","getState","isLoginSuccess","getItem","url","method","headers","then","response","catch","isLoginPending","type","SET_LOGIN_PENDING","SET_LOGIN_SUCCESS","loginError","SET_LOGIN_ERROR","SET_USER_TOKEN","callback","post","setItem","Error"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAOC,OAAP,MAAoB,YAApB;AAEA,OAAO,KAAKC,CAAZ,MAAmB,oBAAnB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;AAEA,MAAMC,IAAI,GAAG,uBAAb,C,CACA;AAGA;;AACA,OAAO,SAASC,KAAT,CAAeC,QAAf,EAAyBC,QAAzB,EAAmC;AACxC,SAAOC,QAAQ,IAAI;AACjBA,IAAAA,QAAQ,CAACC,eAAe,CAAC,IAAD,CAAhB,CAAR;AACAD,IAAAA,QAAQ,CAACE,eAAe,CAAC,KAAD,CAAhB,CAAR;AACAF,IAAAA,QAAQ,CAACG,aAAa,CAAC,IAAD,CAAd,CAAR;AAEAC,IAAAA,YAAY,CAACN,QAAD,EAAWC,QAAX,EAAqB,CAACM,IAAD,EAAOC,KAAP,KAAiB;AAChDN,MAAAA,QAAQ,CAACC,eAAe,CAAC,KAAD,CAAhB,CAAR;;AACA,UAAI,CAACK,KAAL,EAAY;AACVC,QAAAA,OAAO,CAACC,GAAR,CAAYH,IAAZ;;AACA,YAAGA,IAAI,CAACI,OAAL,KAAiB,IAApB,EAAyB;AACvBT,UAAAA,QAAQ,CAACU,YAAY,CAACL,IAAI,CAACM,KAAN,CAAb,CAAR;AACAX,UAAAA,QAAQ,CAACE,eAAe,CAAC,IAAD,CAAhB,CAAR;AACAT,UAAAA,OAAO,CAACmB,IAAR,CAAa,YAAb;AACD,SAJD,MAIK;AACHZ,UAAAA,QAAQ,CAACG,aAAa,CAACE,IAAI,CAACQ,OAAN,CAAd,CAAR;AACAC,UAAAA,KAAK,CAACT,IAAI,CAACQ,OAAN,CAAL;AACD;AACF,OAVD,MAUO;AACLb,QAAAA,QAAQ,CAACG,aAAa,CAACE,IAAI,CAACQ,OAAN,CAAd,CAAR;AACAC,QAAAA,KAAK,CAACT,IAAI,CAACQ,OAAN,CAAL;AACD;AACF,KAhBW,CAAZ;AAiBD,GAtBD;AAuBD;AAED,OAAO,SAASE,MAAT,GAAiB;AACtB,SAAOf,QAAQ,IAAI;AACjBgB,IAAAA,cAAc,CAACC,UAAf,CAA0B,OAA1B;AACAjB,IAAAA,QAAQ,CAACE,eAAe,CAAC,KAAD,CAAhB,CAAR;AACAT,IAAAA,OAAO,CAACmB,IAAR,CAAa,QAAb;AACD,GAJD;AAKD;AAED,OAAO,SAASM,cAAT,GAAyB;AAC9BX,EAAAA,OAAO,CAACC,GAAR,CAAYb,KAAK,CAACwB,QAAN,EAAZ;;AACA,MAAGxB,KAAK,CAACwB,QAAN,GAAiBC,cAApB,EAAmC;AACjCN,IAAAA,KAAK,CAAC,wBAAD,CAAL;AACD,GAFD,MAEK;AACHP,IAAAA,OAAO,CAACC,GAAR,CAAY,yCAAZ;;AACA,QAAGQ,cAAc,CAACK,OAAf,CAAuB,OAAvB,CAAH,EAAmC;AACjCd,MAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ;AACA,UAAIG,KAAK,GAAGK,cAAc,CAACK,OAAf,CAAuB,OAAvB,CAAZ;AACA7B,MAAAA,KAAK,CAAC;AACJ8B,QAAAA,GAAG,EAAE1B,IAAI,GAAG,wBADR;AAEJ2B,QAAAA,MAAM,EAAE,MAFJ;AAGJC,QAAAA,OAAO,EAAE;AACP,wBAAcb;AADP;AAHL,OAAD,CAAL,CAMGc,IANH,CAMUC,QAAD,IAAc;AACrBnB,QAAAA,OAAO,CAACC,GAAR,CAAY,4CAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYkB,QAAZ;AAEE/B,QAAAA,KAAK,CAACK,QAAN,CAAeE,eAAe,CAAC,IAAD,CAA9B;AACAK,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAab,KAAK,CAACwB,QAAN,EAAzB;AACAZ,QAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;AAEH,OAdD,EAeCmB,KAfD,CAeO,UAAUrB,KAAV,EAAiB;AACtBC,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAQ,QAAAA,KAAK,CAAC,qBAAD,CAAL;AACD,OAlBD;AAmBD,KAtBD,MAsBK;AACHA,MAAAA,KAAK,CAAC,gCAAD,CAAL;AACD;AACF;AACF;;AAED,SAASb,eAAT,CAAyB2B,cAAzB,EAAyC;AACvC,SAAO;AACLC,IAAAA,IAAI,EAAEnC,CAAC,CAACoC,iBADH;AAELF,IAAAA;AAFK,GAAP;AAID;;AAED,SAAS1B,eAAT,CAAyBkB,cAAzB,EAAyC;AACvC,SAAO;AACLS,IAAAA,IAAI,EAAEnC,CAAC,CAACqC,iBADH;AAELX,IAAAA;AAFK,GAAP;AAID;;AAED,SAASjB,aAAT,CAAuB6B,UAAvB,EAAmC;AACjC,SAAO;AACLH,IAAAA,IAAI,EAAEnC,CAAC,CAACuC,eADH;AAELD,IAAAA;AAFK,GAAP;AAID;;AAED,SAAStB,YAAT,CAAsBC,KAAtB,EAA6B;AAC3B,SAAO;AACLkB,IAAAA,IAAI,EAAEnC,CAAC,CAACwC,cADH;AAELvB,IAAAA;AAFK,GAAP;AAID;;AAED,SAASP,YAAT,CAAsBN,QAAtB,EAAgCC,QAAhC,EAA0CoC,QAA1C,EAAoD;AAClD3C,EAAAA,KAAK,CAAC4C,IAAN,CAAWxC,IAAI,GAAG,iBAAlB,EAAqC;AACnCE,IAAAA,QAAQ,EAAEA,QADyB;AAEnCC,IAAAA,QAAQ,EAAEA;AAFyB,GAArC,EAIC0B,IAJD,CAIQC,QAAD,IAAc;AACnBnB,IAAAA,OAAO,CAACC,GAAR,CAAYkB,QAAZ;AACAV,IAAAA,cAAc,CAACqB,OAAf,CAAuB,OAAvB,EAAgCX,QAAQ,CAACrB,IAAT,CAAcM,KAA9C;AACA,WAAOwB,QAAQ,CAACT,QAAQ,CAACrB,IAAV,EAAgB,IAAhB,CAAf;AACD,GARD,EASCsB,KATD,CASO,UAAUrB,KAAV,EAAiB;AACtBC,IAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ,EAAkBF,KAAlB;AACA,WAAO6B,QAAQ,CAAC,IAAIG,KAAJ,CAAU,4BAAV,CAAD,CAAf;AACD,GAZD;AAaD","sourcesContent":["import axios from 'axios'\n\nimport history from '../history'\n\nimport * as c from '../redux/constants'\nimport store from '../redux/store'\n\nconst host = 'http://localhost:3005';\n//const host = process.env.API_HOST;\n\n\n//LOGIN\nexport function login(username, password) {\n  return dispatch => {\n    dispatch(setLoginPending(true));\n    dispatch(setLoginSuccess(false));\n    dispatch(setLoginError(null));\n\n    callLoginApi(username, password, (data, error) => {\n      dispatch(setLoginPending(false));\n      if (!error) {\n        console.log(data);\n        if(data.success === true){\n          dispatch(setUserToken(data.token));\n          dispatch(setLoginSuccess(true));\n          history.push('/dashboard');\n        }else{\n          dispatch(setLoginError(data.message));\n          alert(data.message);\n        }\n      } else {\n        dispatch(setLoginError(data.message));\n        alert(data.message);\n      }\n    });\n  }\n}\n\nexport function logout(){\n  return dispatch => {\n    sessionStorage.removeItem('CWJWT');\n    dispatch(setLoginSuccess(false));\n    history.push('/login');\n  }\n}\n\nexport function verifyLoggedIn(){\n  console.log(store.getState())\n  if(store.getState().isLoginSuccess){\n    alert('Jwt Present, auth true')\n  }else{\n    console.log('Not logged in in STATE checking for JWT')\n    if(sessionStorage.getItem('CWJWT')){\n      console.log('jwt present sending request')\n      let token = sessionStorage.getItem('CWJWT');\n      axios({\n        url: host + '/api/user/authenticate',\n        method: 'POST',\n        headers: {\n          'auth-token': token,\n        },\n      }).then( (response) => {\n        console.log('successfully authed from stored auth token')\n        console.log(response)\n        \n          store.dispatch(setLoginSuccess(true));\n          console.log('FINALE: ' + store.getState())\n          console.log('setting STATE logged in to TRUE')\n        \n      })\n      .catch(function (error) {\n        console.log(error);\n        alert('error with response')\n      });\n    }else{\n      alert('JWT not present please sign in')\n    }\n  }\n}\n\nfunction setLoginPending(isLoginPending) {\n  return {\n    type: c.SET_LOGIN_PENDING,\n    isLoginPending\n  };\n}\n\nfunction setLoginSuccess(isLoginSuccess) {\n  return {\n    type: c.SET_LOGIN_SUCCESS,\n    isLoginSuccess\n  };\n}\n\nfunction setLoginError(loginError) {\n  return {\n    type: c.SET_LOGIN_ERROR,\n    loginError\n  }\n}\n\nfunction setUserToken(token) {\n  return {\n    type: c.SET_USER_TOKEN,\n    token\n  }\n}\n\nfunction callLoginApi(username, password, callback) {\n  axios.post(host + '/api/user/login', {\n    username: username,\n    password: password\n  })\n  .then( (response) => {\n    console.log(response)\n    sessionStorage.setItem('CWJWT', response.data.token);\n    return callback(response.data, null);\n  })\n  .catch(function (error) {\n    console.log(null, error);\n    return callback(new Error('Invalid email and password'));\n  });\n}\n"]},"metadata":{},"sourceType":"module"}